var recommendFundApi="https://api.fund.eastmoney.com/trade/GetZhiShuRecommendFundByCustomerNo?callback=?&lt=";$(document).ready(function(){var indexHisotyKey="indexHistory";var allIndexQuery={marketType:null,dateType:"D"};renderVisitHistory();getInterestedFund();if(JSON.stringify($.hash.getAll())==="{}"){$.hash.set({tab:"zsb",alllx:"",zsblx:"all",allsyl:"d",zsbsyl:"4",sort:"desc"})}else{switch($.hash.get("tab")){case"zsb":tabSwitch($(".tab_btn li[data-tab='zsb']"));break;case"all":tabSwitch($(".tab_btn li[data-tab='all']"));break;default:tabSwitch($(".tab_btn li[data-tab='zsb']"))}switch($.hash.get("alllx").toString()){case"0":all_style($(".all_index span[data-market='']"));break;case"1":all_style($(".all_index span[data-market='1']"));break;case"2":all_style($(".all_index span[data-market='2']"));break;case"3":all_style($(".all_index span[data-market='3']"));break;default:all_style($(".all_index span[data-market='']"))}switch($.hash.get("zsblx")){case"all":zsb_style($(".index_concat span[data-show='all']"));break;case"hs":zsb_style($(".index_concat span[data-show='hs']"));break;case"hy":zsb_style($(".index_concat span[data-show='hy']"));break;case"qq":zsb_style($(".index_concat span[data-show='qq']"));break;default:zsb_style($(".index_concat span[data-show='all']"))}switch($.hash.get("allsyl")){case"d":all_syl($(".all_index span[data-dt='d']"));break;case"w":all_syl($(".all_index span[data-dt='w']"));break;case"m":all_syl($(".all_index span[data-dt='m']"));break;case"q":all_syl($(".all_index span[data-dt='q']"));break;case"hy":all_syl($(".all_index span[data-dt='hy']"));break;case"y":all_syl($(".all_index span[data-dt='y']"));break;default:all_syl($(".all_index span[data-dt='d']"))}switch($.hash.get("zsbsyl").toString()){case"0":zsb_syl($(".index_concat_table th[data-dt='0']"),$.hash.get("sort").toString());break;case"1":zsb_syl($(".index_concat_table th[data-dt='1']"),$.hash.get("sort").toString());break;case"2":zsb_syl($(".index_concat_table th[data-dt='2']"),$.hash.get("sort").toString());break;case"3":zsb_syl($(".index_concat_table th[data-dt='3']"),$.hash.get("sort").toString());break;case"4":zsb_syl($(".index_concat_table th[data-dt='4']"),$.hash.get("sort").toString());break;case"5":zsb_syl($(".index_concat_table th[data-dt='5']"),$.hash.get("sort").toString());break;case"6":zsb_syl($(".index_concat_table th[data-dt='6']"),$.hash.get("sort").toString());break;case"7":zsb_syl($(".index_concat_table th[data-dt='7']"),$.hash.get("sort").toString());break;case"8":zsb_syl($(".index_concat_table th[data-dt='8']"),$.hash.get("sort").toString());break;default:zsb_syl($(".index_concat_table th[data-dt='0']"),$.hash.get("sort").toString())}switch($.hash.get("sort")){case"desc":zsb_sort($(".index_concat_table th[data-dt='"+$.hash.get("zsbsyl").toString()+"']"),"desc");break;case"asc":zsb_sort($(".index_concat_table th[data-dt='"+$.hash.get("zsbsyl").toString()+"']"),"asc");break;default:zsb_sort($(".index_concat_table th[data-dt='"+$.hash.get("zsbsyl").toString()+"']"),"desc")}if($.hash.get("tab")=="all"){loadAllIndex(allIndexQuery.marketType,allIndexQuery.dateType)}}$(".tab_btn li").off("click").on("click",function(e){var e=$(e.currentTarget);tabSwitch(e);if(e.data("tab")=="all"){loadAllIndex(allIndexQuery.marketType,allIndexQuery.dateType)}});function tabSwitch(e){var target=e;var activeLi=$(".tab_btn li.active");activeLi.removeClass("active");target.addClass("active");if(target.hasClass("btnO")){$(".index_concat").show();$(".all_index ").hide()}else{$(".index_concat").hide();$(".all_index ").show()}$.hash.set("tab",target.data("tab"))}$(".problem .question ").off("click").on("click",function(e){var target=$(e.currentTarget);var answer=target.next(".answer");if(target.hasClass("active")){target.removeClass("active");answer.hide()}else{target.addClass("active");answer.show()}});$("table th.sort ").off("click").on("click",function(e){var sortType=getThSortType(".index_concat_table",$(this)[0]);var colIndex=$(this).index();tableSort(".index_concat_table",colIndex,sortType);$.hash.set("zsbsyl",($(this).index()-1).toString());$.hash.set("sort",sortType)});function zsb_syl(e,sortType){var target=e;var sortType=getThSortType(".index_concat_table",target[0]);var colIndex=target.index();tableSort(".index_concat_table",colIndex,sortType);$.hash.set("zsbsyl",(target.index()-1).toString())}function zsb_sort(e,sortType){var target=e;var asc=target.find(".triangle .asc");var desc=target.find(".triangle .desc");if(sortType=="asc"){desc.removeClass("active");asc.addClass("active");desc.css("border-color","#999 #F5F5F5 #F5F5F5 #F5F5F5");asc.css("border-color"," #F5F5F5 #F5F5F5 #ff3300 #F5F5F5")}else{asc.removeClass("active");desc.addClass("active");asc.css("border-color"," #F5F5F5 #F5F5F5 #999 #F5F5F5");desc.css("border-color","#ff3300 #F5F5F5 #F5F5F5 #F5F5F5")}var colIndex=target.index();tableSort(".index_concat_table",colIndex,sortType);$.hash.set("sort",sortType)}$(".style_tab .ospan").off("click").on("click",function(e){var e=$(e.currentTarget);zsb_style(e)});function zsb_style(e){var target=e;var removeActive=$(".style_tab .ospan.active");removeActive.removeClass("active");target.addClass("active");var market=target.data("show");var $tbl=$(".index_concat_table ");var evenCls="tr-even";$tbl.removeClass("show-all show-hs show-hy show-qq");$tbl.addClass("show-"+market);$tbl.find("."+evenCls).removeClass(evenCls);$tbl.find("tr:visible").filter(":even").addClass(evenCls);$.hash.set("zsblx",market)}$(".all_index .scSpan").off("click").on("click",function(e){var e=$(e.currentTarget);all_style(e);loadAllIndex(allIndexQuery.marketType,allIndexQuery.dateType)});function all_style(e){var target=e;var removeActive=$(".all_index .scSpan.active");removeActive.removeClass("active");target.addClass("active");allIndexQuery.marketType=(target.data("market"));$.hash.set("alllx",target.data("market"))}$(".all_index .jdSpan").off("click").on("click",function(e){var e=$(e.currentTarget);all_syl(e);loadAllIndex(allIndexQuery.marketType,allIndexQuery.dateType)});function all_syl(e){var target=e;var removeActive=$(".all_index .jdSpan.active");removeActive.removeClass("active");target.addClass("active");allIndexQuery.dateType=target.data("dt").toUpperCase();$.hash.set("allsyl",target.data("dt"))}$("#allIndexWrap ").on("click",".link",function(e){e.preventDefault();var code=$(this).attr("data-code");var name=$(this).data("name");writeVisitHistoryToCookie(code,name);window.open($(this).data("href"))});$("#visitHis").on("click",".visit-history-item",function(e){e.preventDefault();var code=$(this).attr("data-code");var name=$(this).data("name");writeVisitHistoryToCookie(code,name);renderVisitHistory();window.open($(this).data("href"))});function renderVisitHistory(){var history=getCookie(indexHisotyKey);if(history!=""){var $visitHis=$("#visitHis");var ret="";var hisArr=history.split(",");var itemArr;var detailUrl=$visitHis.data("detailurl");for(var i=0,len=hisArr.length;i<len;i++){itemArr=hisArr[i].split(":");ret+="<a class='visit-history-item m_r_18 ' data-code='"+itemArr[0]+"' data-name='"+itemArr[1]+"'  data-href='"+detailUrl+"?code="+itemArr[0]+"'>"+itemArr[1]+"</a>"}$visitHis.html(ret)}}function getInterestedFund(){}function getDefaultFunds(funds){try{var strFunds="";if(!!funds){strFunds=funds}$.get(resolveUrl("/home/GetInterested"),{strFunds:strFunds},function(data){var arr=[];if(!!data){for(var i=0,len=data.length;i<len;i++){arr.push('<li class="fl">');arr.push('<p class="item-title"><a href="http://fund.eastmoney.com/',data[i].FCODE,'.html?spm=17090702.zsb.pc">',data[i].SHORTNAME.substring(0,18),"</a></p>");arr.push('<p class="">',data[i].SYL_3Y_STR,"</p>");arr.push('<p class="month">'+data[i].SYLDesc+"</p>");arr.push('<div class="button">',data[i].BtnBuy,"</div>");arr.push("</li>")}}else{$(".like").hide()}$("#InterestedContent").html(arr.join(""))}).fail(function(){$("#InterestedContent").html("");$(".like").hide()})}catch(e){$("#InterestedContent").html("");$(".like").hide()}}function loadAllIndex(marketType,dateType){$("#allIndexWrap").load(resolveUrl("/home/AllIndex"),{marketType:marketType,dateType:dateType})}function writeVisitHistoryToCookie(code,name){var history=getCookie(indexHisotyKey);if(history){history+=","}var val=code+":"+name+",";if(history.indexOf(val)>-1){history=history.replace(val,"")}history=val+history;if(history.length==history.lastIndexOf(",")+1){history=history.substring(0,history.length-1)}setCookie(indexHisotyKey,history,360)}});